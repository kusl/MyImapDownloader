Purpose & context
Kushal is developing and maintaining MyImapDownloader, a .NET 10 email archiving and search system designed to safely backup emails from multiple IMAP accounts. The system consists of two main components: MyImapDownloader for downloading emails from IMAP servers, and MyEmailSearch for indexing and searching the downloaded archives. Kushal manages multiple email accounts across different providers (mailo.com, disroot.org, gmx.com) and maintains a comprehensive backup workflow that downloads from all accounts into separate directories under ~/Documents/mail/. The archive has grown to 35GB+ across multiple accounts, with potential to reach hundreds of gigabytes over time.
Core values include safety-first design (read-only IMAP operations with append-only local storage), free and open source software dependencies only, and delivering complete, immediately actionable solutions rather than fragmented instructions. The project emphasizes data integrity, crash safety through atomic write patterns, and comprehensive observability via OpenTelemetry instrumentation.
Current state
The MyImapDownloader component is fully functional and actively used for email archival, with delta synchronization working correctly to avoid re-downloading existing emails. The SQLite-backed indexing system maintains efficient deduplication via Message-ID tracking while keeping database overhead minimal (190KB for 35GB of email data). The system successfully handles multiple email accounts with robust error handling and self-healing database recovery.
The MyEmailSearch component has been developed and integrated into the solution structure, providing CLI-based search capabilities over the email archives using SQLite FTS5 for full-text search. Recent development focused on resolving compilation issues with System.CommandLine API migration from beta4 to beta5+, fixing namespace references, and implementing proper async patterns. The search system supports structured queries (by sender, recipient, subject, date ranges) and full-text content searches with performance targets of sub-500ms for structured queries and sub-1-second for full-text searches.
Key learnings & principles
The project has established several core architectural principles through iterative development. Safety guarantees are paramount - the system operates in read-only mode against IMAP servers and uses atomic write patterns for crash safety. Delta synchronization with UIDVALIDITY indexing provides efficient deduplication without data loss. The codebase prioritizes complete, single-file shell scripts for fixes and implementations rather than fragmented multi-file changes.
Technical debt management follows a pattern of comprehensive analysis followed by complete resolution scripts. When compilation errors arise, the approach involves creating bash scripts that systematically address all issues simultaneously rather than piecemeal fixes. The System.CommandLine API migration revealed the importance of staying current with dependency versions while maintaining backward compatibility.
Approach & patterns
Development follows a systematic approach of analyzing the complete codebase state (via dump.txt files) before making changes, ensuring all modifications are grounded in actual project requirements rather than assumptions. Code reviews focus on security concerns like FTS5 injection vulnerabilities, robustness issues including error handling for broken pipe scenarios, and performance optimizations.
The workflow involves building, testing, running the email downloader against IMAP servers, and committing results to git. For search functionality, the pattern includes incremental indexing that processes only new emails based on timestamp tracking and database existence checks. Testing uses TUnit framework with comprehensive coverage of query parsing, snippet generation, and database operations.
Tools & resources
The technology stack centers on .NET 10 with SQLite for local storage and FTS5 for full-text search capabilities. Key dependencies include System.CommandLine for CLI interfaces, MimeKit for email parsing, MailKit for IMAP operations, and Polly for resilience patterns including retry logic and circuit breakers. The project uses Microsoft.Extensions for dependency injection and structured logging.
Development tooling includes comprehensive bash scripts for fixes and implementations, XDG-compliant directory resolution for cross-platform compatibility, and OpenTelemetry for observability with JSONL output formats. The build system uses Directory.Build.props, Directory.Build.targets, and Directory.Packages.props for centralized package management across multiple projects in the solution.
