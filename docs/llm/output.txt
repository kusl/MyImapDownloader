Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Install the latest PowerShell for new features and improvements! https://aka.ms/PSWindows

PS C:\Users\kushal> Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:20:29
PS C:\Users\kushal> Set-Location "C:\Users\kushal\source\repos\"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git clone https://github.com/kusl/MyImapDownloader; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:21:08
Cloning into 'MyImapDownloader'...
remote: Enumerating objects: 49, done.
remote: Counting objects: 100% (49/49), done.
remote: Compressing objects: 100% (33/33), done.
remote: Total 49 (delta 26), reused 39 (delta 16), pack-reused 0 (from 0)
Receiving objects: 100% (49/49), 30.92 KiB | 3.87 MiB/s, done.
Resolving deltas: 100% (26/26), done.
2025-12-18 13:21:09
PS C:\Users\kushal\source\repos> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:21:43
On branch main
Your branch is up to date with 'origin/main'.

nothing to commit, working tree clean
2025-12-18 13:21:43
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:21:43
PS C:\Users\kushal\source\repos\MyImapDownloader> git remote add mine https://github.com/collabskus/MyImapDownloader.git
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:22:55
On branch main
Your branch is up to date with 'origin/main'.

nothing to commit, working tree clean
2025-12-18 13:22:55
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:22:56
Enumerating objects: 49, done.
Counting objects: 100% (49/49), done.
Delta compression using up to 12 threads
Compressing objects: 100% (23/23), done.
Writing objects: 100% (49/49), 30.92 KiB | 15.46 MiB/s, done.
Total 49 (delta 26), reused 49 (delta 26), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (26/26), done.
To https://github.com/collabskus/MyImapDownloader.git
 * [new branch]      main -> main
2025-12-18 13:22:57
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:25:41
On branch main
Your branch is up to date with 'origin/main'.

Untracked files:
  (use "git add <file>..." to include in what will be committed)
        docs/
        export.ps1

nothing added to commit but untracked files present (use "git add" to track)
2025-12-18 13:25:41
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:25:41
Everything up-to-date
2025-12-18 13:25:42
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 13:25:42
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 9 files to export
Processing (1/9): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (2/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (3/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (4/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (5/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (6/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (7/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (8/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (9/9): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 9
Output file size: 0.02 MB
2025-12-18 13:25:42
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:26:30
On branch main
Your branch is up to date with 'origin/main'.

Untracked files:
  (use "git add <file>..." to include in what will be committed)
        docs/
        export.ps1

nothing added to commit but untracked files present (use "git add" to track)
2025-12-18 13:26:30
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:26:30
Everything up-to-date
2025-12-18 13:26:30
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 13:26:30
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 9 files to export
Processing (1/9): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (2/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (3/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (4/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (5/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (6/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (7/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (8/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (9/9): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 9
Output file size: 0.02 MB
2025-12-18 13:26:31
2025-12-18 13:26:31
[main b4a76aa] dump code for llm
 3 files changed, 867 insertions(+)
 create mode 100644 docs/llm/.gitkeep
 create mode 100644 docs/llm/dump.txt
 create mode 100644 export.ps1
2025-12-18 13:26:31
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:26:58
On branch main
Your branch is ahead of 'origin/main' by 1 commit.
  (use "git push" to publish your local commits)

nothing to commit, working tree clean
2025-12-18 13:26:58
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:26:58
Enumerating objects: 8, done.
Counting objects: 100% (8/8), done.
Delta compression using up to 12 threads
Compressing objects: 100% (5/5), done.
Writing objects: 100% (7/7), 7.82 KiB | 3.91 MiB/s, done.
Total 7 (delta 1), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (1/1), completed with 1 local object.
To https://github.com/collabskus/MyImapDownloader.git
   d5f9c40..b4a76aa  main -> main
2025-12-18 13:26:59
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 13:26:59
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 9 files to export
Processing (1/9): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (2/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (3/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (4/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (5/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (6/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (7/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (8/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (9/9): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 9
Output file size: 0.02 MB
2025-12-18 13:26:59
2025-12-18 13:27:00
[main 40afc62] dump code for llm
 1 file changed, 2 insertions(+), 2 deletions(-)
2025-12-18 13:27:00
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:27:00

Build succeeded in 0.4s
2025-12-18 13:27:01
Restore complete (0.5s)
  MyImapDownloader net9.0 succeeded (2.3s) â†’ MyImapDownloader\bin\Debug\net9.0\MyImapDownloader.dll

Build succeeded in 3.0s
2025-12-18 13:27:04
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet outdated; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:29:04
On branch main
Your branch is ahead of 'origin/main' by 2 commits.
  (use "git push" to publish your local commits)

Untracked files:
  (use "git add <file>..." to include in what will be committed)
        docs/llm/output.txt

nothing added to commit but untracked files present (use "git add" to track)
2025-12-18 13:29:04
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:29:05
Enumerating objects: 9, done.
Counting objects: 100% (9/9), done.
Delta compression using up to 12 threads
Compressing objects: 100% (4/4), done.
Writing objects: 100% (5/5), 417 bytes | 417.00 KiB/s, done.
Total 5 (delta 2), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (2/2), completed with 2 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   b4a76aa..40afc62  main -> main
2025-12-18 13:29:06
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 13:29:06
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 9 files to export
Processing (1/9): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (2/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (3/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (4/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (5/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (6/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (7/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (8/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (9/9): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 9
Output file size: 0.03 MB
2025-12-18 13:29:06
2025-12-18 13:29:06
[main e1675ad] dump code for llm
 2 files changed, 1218 insertions(+), 2 deletions(-)
 create mode 100644 docs/llm/output.txt
2025-12-18 13:29:06
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:29:07

Build succeeded in 0.4s
2025-12-18 13:29:07
Restore complete (0.4s)
  MyImapDownloader net9.0 succeeded (0.5s) â†’ MyImapDownloader\bin\Debug\net9.0\MyImapDownloader.dll

Build succeeded in 1.1s
2025-12-18 13:29:08
Discovering projects...
Analyzing project(s)...
Analyzing dependencies...
Â» MyImapDownloader
  [net9.0]
  MailKit                                   4.13.0 -> 4.14.1
  Microsoft.Extensions.Configuration        9.0.6  -> 10.0.1
  Microsoft.Extensions.DependencyInjection  9.0.6  -> 10.0.1
  Microsoft.Extensions.Hosting              9.0.6  -> 10.0.1
  Microsoft.Extensions.Logging              9.0.6  -> 10.0.1
  Microsoft.Extensions.Logging.Console      9.0.6  -> 10.0.1
  Polly                                     8.6.1  -> 8.6.5

Version color legend:
<red>   : Major version update or pre-release version. Possible breaking changes.
<yellow>: Minor version update. Backwards-compatible features added.
<green> : Patch version update. Backwards-compatible bug fixes.

You can upgrade packages to the latest version by passing the -u or -u:prompt option.
Elapsed: 00:00:01.9201195
2025-12-18 13:29:11
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet outdated; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:30:41
On branch main
Your branch is ahead of 'origin/main' by 3 commits.
  (use "git push" to publish your local commits)

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   Directory.Packages.props
        modified:   MyImapDownloader/MyImapDownloader.csproj

no changes added to commit (use "git add" and/or "git commit -a")
2025-12-18 13:30:41
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:30:41
Enumerating objects: 10, done.
Counting objects: 100% (10/10), done.
Delta compression using up to 12 threads
Compressing objects: 100% (5/5), done.
Writing objects: 100% (6/6), 5.35 KiB | 2.67 MiB/s, done.
Total 6 (delta 2), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (2/2), completed with 2 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   40afc62..e1675ad  main -> main
2025-12-18 13:30:42
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 13:30:42
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 9 files to export
Processing (1/9): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (2/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (3/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (4/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (5/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (6/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (7/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (8/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (9/9): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 9
Output file size: 0.03 MB
2025-12-18 13:30:43
2025-12-18 13:30:43
[main 61cdfec] dump code for llm
 3 files changed, 32 insertions(+), 20 deletions(-)
2025-12-18 13:30:43
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:30:44

Build succeeded in 0.4s
2025-12-18 13:30:44
Restore complete (0.4s)
  MyImapDownloader net10.0 succeeded (0.9s) â†’ MyImapDownloader\bin\Debug\net10.0\MyImapDownloader.dll

Build succeeded in 1.5s
2025-12-18 13:30:46
Discovering projects...
Analyzing project(s)...
Analyzing dependencies...
No outdated dependencies were detected
Elapsed: 00:00:01.8606576
2025-12-18 13:30:48
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet outdated; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:31:10
On branch main
Your branch is ahead of 'origin/main' by 4 commits.
  (use "git push" to publish your local commits)

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   docs/llm/output.txt

no changes added to commit (use "git add" and/or "git commit -a")
2025-12-18 13:31:10
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:31:10
Enumerating objects: 15, done.
Counting objects: 100% (15/15), done.
Delta compression using up to 12 threads
Compressing objects: 100% (7/7), done.
Writing objects: 100% (8/8), 841 bytes | 841.00 KiB/s, done.
Total 8 (delta 5), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (5/5), completed with 4 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   e1675ad..61cdfec  main -> main
2025-12-18 13:31:11
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 13:31:11
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 9 files to export
Processing (1/9): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (2/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (3/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (4/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (5/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (6/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (7/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (8/9): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (9/9): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 9
Output file size: 0.03 MB
2025-12-18 13:31:11
2025-12-18 13:31:11
[main d3a3d00] dump code for llm
 2 files changed, 860 insertions(+), 3 deletions(-)
2025-12-18 13:31:12
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:31:12

Build succeeded in 0.4s
2025-12-18 13:31:13
Restore complete (0.7s)
  MyImapDownloader net10.0 succeeded (0.5s) â†’ MyImapDownloader\bin\Debug\net10.0\MyImapDownloader.dll

Build succeeded in 1.4s
2025-12-18 13:31:14
Discovering projects...
Analyzing project(s)...
Analyzing dependencies...
No outdated dependencies were detected
Elapsed: 00:00:01.9234911
2025-12-18 13:31:16
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet outdated; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:47:46
On branch main
Your branch is ahead of 'origin/main' by 6 commits.
  (use "git push" to publish your local commits)

nothing to commit, working tree clean
2025-12-18 13:47:46
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:47:47
Enumerating objects: 21, done.
Counting objects: 100% (21/21), done.
Delta compression using up to 12 threads
Compressing objects: 100% (12/12), done.
Writing objects: 100% (14/14), 9.96 KiB | 3.32 MiB/s, done.
Total 14 (delta 6), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (6/6), completed with 4 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   61cdfec..0ab8ac6  main -> main
2025-12-18 13:47:48
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 13:47:48
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 10 files to export
Processing (1/10): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (2/10): :\Users\kushal\source\repos\MyImapDownloader\EmailStorageService.cs
Processing (3/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (4/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (5/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (6/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (7/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (8/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (9/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (10/10): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 10
Output file size: 0.04 MB
2025-12-18 13:47:48
2025-12-18 13:47:48
[main 868c455] dump code for llm
 1 file changed, 329 insertions(+), 40 deletions(-)
2025-12-18 13:47:48
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:47:49

Build succeeded in 0.4s
2025-12-18 13:47:49
Restore complete (0.7s)
  MyImapDownloader net10.0 failed with 3 error(s) (2.0s)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs(16,45): error CS1061: 'DownloadOptions' does not contain a definition for 'Verbose' and no accessible extension method 'Verbose' accepting a first argument of type 'DownloadOptions' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs(30,60): error CS0246: The type or namespace name 'EmailStorageService' could not be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs(31,28): error CS0246: The type or namespace name 'EmailStorageService' could not be found (are you missing a using directive or an assembly reference?)

Build failed with 3 error(s) in 2.9s
2025-12-18 13:47:52
Discovering projects...
Analyzing project(s)...
Analyzing dependencies...
No outdated dependencies were detected
Elapsed: 00:00:01.8603378
2025-12-18 13:47:55
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:49:25
On branch main
Your branch is ahead of 'origin/main' by 8 commits.
  (use "git push" to publish your local commits)

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   docs/llm/output.txt

no changes added to commit (use "git add" and/or "git commit -a")
2025-12-18 13:49:25
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:49:25
Enumerating objects: 17, done.
Counting objects: 100% (17/17), done.
Delta compression using up to 12 threads
Compressing objects: 100% (9/9), done.
Writing objects: 100% (10/10), 6.16 KiB | 1.54 MiB/s, done.
Total 10 (delta 7), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (7/7), completed with 5 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   0ab8ac6..2b59169  main -> main
2025-12-18 13:49:26
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 13:49:26
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 10 files to export
Processing (1/10): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (2/10): :\Users\kushal\source\repos\MyImapDownloader\EmailStorageService.cs
Processing (3/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (4/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (5/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (6/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (7/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (8/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (9/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (10/10): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 10
Output file size: 0.03 MB
2025-12-18 13:49:27
2025-12-18 13:49:27
[main 8fa0005] dump code for llm
 2 files changed, 949 insertions(+), 288 deletions(-)
2025-12-18 13:49:27
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:49:27

Build succeeded in 0.4s
2025-12-18 13:49:28
Restore complete (0.7s)
  MyImapDownloader net10.0 failed with 2 error(s) (0.3s)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(17,22): error CS0246: The type or namespace name 'EmailStorageService' could not be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(24,9): error CS0246: The type or namespace name 'EmailStorageService' could not be found (are you missing a using directive or an assembly reference?)

Build failed with 2 error(s) in 1.2s
2025-12-18 13:49:29
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:50:32
On branch main
Your branch is ahead of 'origin/main' by 10 commits.
  (use "git push" to publish your local commits)

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   docs/llm/output.txt

no changes added to commit (use "git add" and/or "git commit -a")
2025-12-18 13:50:33
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:50:33
Enumerating objects: 15, done.
Counting objects: 100% (15/15), done.
Delta compression using up to 12 threads
Compressing objects: 100% (8/8), done.
Writing objects: 100% (9/9), 3.88 KiB | 1.29 MiB/s, done.
Total 9 (delta 5), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (5/5), completed with 4 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   2b59169..d2a9583  main -> main
2025-12-18 13:50:34
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 13:50:34
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 10 files to export
Processing (1/10): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (2/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (3/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (4/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (5/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (6/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs
Processing (7/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (8/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (9/10): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (10/10): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 10
Output file size: 0.03 MB
2025-12-18 13:50:34
2025-12-18 13:50:34
[main 1f58e95] dump code for llm
 2 files changed, 882 insertions(+), 496 deletions(-)
2025-12-18 13:50:34
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:50:35

Build succeeded in 0.4s
2025-12-18 13:50:35
Restore complete (0.5s)
  MyImapDownloader net10.0 succeeded with 1 warning(s) (0.7s) â†’ MyImapDownloader\bin\Debug\net10.0\MyImapDownloader.dll
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs(70,28): warning CS0168: The variable 'ex' is declared but never used

Build succeeded with 1 warning(s) in 1.4s
2025-12-18 13:50:37
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:52:15
On branch main
Your branch is ahead of 'origin/main' by 12 commits.
  (use "git push" to publish your local commits)

nothing to commit, working tree clean
2025-12-18 13:52:15
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:52:16
Enumerating objects: 15, done.
Counting objects: 100% (15/15), done.
Delta compression using up to 12 threads
Compressing objects: 100% (9/9), done.
Writing objects: 100% (10/10), 2.06 KiB | 702.00 KiB/s, done.
Total 10 (delta 4), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (4/4), completed with 3 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   d2a9583..4c455d4  main -> main
2025-12-18 13:52:17
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 13:52:17
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 11 files to export
Processing (1/11): :\Users\kushal\source\repos\MyImapDownloader\Directory.Build.props
Processing (2/11): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (3/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (4/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (5/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (6/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (7/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs
Processing (8/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (9/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (10/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (11/11): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 11
Output file size: 0.04 MB
2025-12-18 13:52:17
2025-12-18 13:52:17
[main b073bb4] dump code for llm
 1 file changed, 84 insertions(+), 3 deletions(-)
2025-12-18 13:52:17
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:52:17

Build succeeded in 0.4s
2025-12-18 13:52:18
Restore complete (0.9s)
  MyImapDownloader net10.0 succeeded with 1 warning(s) (0.6s) â†’ MyImapDownloader\bin\Debug\net10.0\MyImapDownloader.dll
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs(70,28): warning CS0168: The variable 'ex' is declared but never used

Build succeeded with 1 warning(s) in 1.7s
2025-12-18 13:52:20
PS C:\Users\kushal\source\repos\MyImapDownloader>
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 13:55:12
On branch main
Your branch is ahead of 'origin/main' by 14 commits.
  (use "git push" to publish your local commits)

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   docs/llm/output.txt

no changes added to commit (use "git add" and/or "git commit -a")
2025-12-18 13:55:12
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:55:12
Enumerating objects: 15, done.
Counting objects: 100% (15/15), done.
Delta compression using up to 12 threads
Compressing objects: 100% (8/8), done.
Writing objects: 100% (9/9), 1.45 KiB | 743.00 KiB/s, done.
Total 9 (delta 6), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (6/6), completed with 5 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   4c455d4..cfc3aaf  main -> main
2025-12-18 13:55:13
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 13:55:13
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 11 files to export
Processing (1/11): :\Users\kushal\source\repos\MyImapDownloader\Directory.Build.props
Processing (2/11): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (3/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (4/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (5/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (6/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (7/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs
Processing (8/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (9/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (10/11): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (11/11): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 11
Output file size: 0.03 MB
2025-12-18 13:55:13
2025-12-18 13:55:13
[main 30b491c] dump code for llm
 2 files changed, 779 insertions(+), 87 deletions(-)
2025-12-18 13:55:13
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 13:55:14

Build succeeded in 0.4s
2025-12-18 13:55:14
Restore complete (0.7s)
  MyImapDownloader net10.0 succeeded (0.6s) â†’ MyImapDownloader\bin\Debug\net10.0\MyImapDownloader.dll

Build succeeded in 1.5s
2025-12-18 13:55:16
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 14:08:58
On branch main
Your branch is ahead of 'origin/main' by 16 commits.
  (use "git push" to publish your local commits)

nothing to commit, working tree clean
2025-12-18 14:08:58
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 14:08:58
Enumerating objects: 39, done.
Counting objects: 100% (39/39), done.
Delta compression using up to 12 threads
Compressing objects: 100% (25/25), done.
Writing objects: 100% (27/27), 22.20 KiB | 3.17 MiB/s, done.
Total 27 (delta 7), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (7/7), completed with 6 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   cfc3aaf..a480005  main -> main
2025-12-18 14:08:59
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 14:08:59
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 19 files to export
Processing (1/19): :\Users\kushal\source\repos\MyImapDownloader\Directory.Build.props
Processing (2/19): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (3/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (4/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\appsettings.json
Processing (5/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (6/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (7/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (8/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs
Processing (9/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (10/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (11/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (12/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\DiagnosticsConfig.cs
Processing (13/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileLogExporter.cs
Processing (14/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileMetricsExporter.cs
Processing (15/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileTraceExporter.cs
Processing (16/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonTelemetryFileWriter.cs
Processing (17/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryConfiguration.cs
Processing (18/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryExtensions.cs
Processing (19/19): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 19
Output file size: 0.08 MB
2025-12-18 14:08:59
2025-12-18 14:08:59
[main b445949] dump code for llm
 1 file changed, 1298 insertions(+), 116 deletions(-)
2025-12-18 14:09:00
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 14:09:00

Build succeeded in 0.4s
2025-12-18 14:09:00
Restore complete (0.7s)
  MyImapDownloader net10.0 failed with 11 error(s) (2.1s)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs(88,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs(126,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(125,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(132,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileMetricsExporter.cs(80,73): error CS1061: 'ExponentialHistogramData' does not contain a definition for 'Sum' and no accessible extension method 'Sum' accepting a first argument of type 'ExponentialHistogramData' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileMetricsExporter.cs(81,73): error CS1061: 'ExponentialHistogramData' does not contain a definition for 'Count' and no accessible extension method 'Count' accepting a first argument of type 'ExponentialHistogramData' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(244,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs(253,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(425,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs(325,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(448,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)

Build failed with 11 error(s) in 3.0s
2025-12-18 14:09:04
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet outdated; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 14:11:43
On branch main
Your branch is ahead of 'origin/main' by 17 commits.
  (use "git push" to publish your local commits)

nothing to commit, working tree clean
2025-12-18 14:11:44
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 14:11:44
Enumerating objects: 9, done.
Counting objects: 100% (9/9), done.
Delta compression using up to 12 threads
Compressing objects: 100% (4/4), done.
Writing objects: 100% (5/5), 15.17 KiB | 7.58 MiB/s, done.
Total 5 (delta 2), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (2/2), completed with 2 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   a480005..b445949  main -> main
2025-12-18 14:11:45
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 14:11:45
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 19 files to export
Processing (1/19): :\Users\kushal\source\repos\MyImapDownloader\Directory.Build.props
Processing (2/19): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (3/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (4/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\appsettings.json
Processing (5/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (6/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (7/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (8/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs
Processing (9/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (10/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (11/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (12/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\DiagnosticsConfig.cs
Processing (13/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileLogExporter.cs
Processing (14/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileMetricsExporter.cs
Processing (15/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileTraceExporter.cs
Processing (16/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonTelemetryFileWriter.cs
Processing (17/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryConfiguration.cs
Processing (18/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryExtensions.cs
Processing (19/19): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 19
Output file size: 0.07 MB
2025-12-18 14:11:45
2025-12-18 14:11:45
[main b72e67f] dump code for llm
 1 file changed, 2 insertions(+), 62 deletions(-)
2025-12-18 14:11:45
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 14:11:45

Build succeeded in 0.4s
2025-12-18 14:11:46
Restore complete (0.7s)
  MyImapDownloader net10.0 failed with 11 error(s) (0.4s)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileMetricsExporter.cs(80,73): error CS1061: 'ExponentialHistogramData' does not contain a definition for 'Sum' and no accessible extension method 'Sum' accepting a first argument of type 'ExponentialHistogramData' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileMetricsExporter.cs(81,73): error CS1061: 'ExponentialHistogramData' does not contain a definition for 'Count' and no accessible extension method 'Count' accepting a first argument of type 'ExponentialHistogramData' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs(126,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs(88,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(125,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(132,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(244,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs(253,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs(325,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(425,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(448,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)

Build failed with 11 error(s) in 1.3s
2025-12-18 14:11:48
Discovering projects...
Analyzing project(s)...
Analyzing dependencies...
Â» MyImapDownloader
  [net10.0]
  OpenTelemetry                          1.11.2 -> 1.14.0
  OpenTelemetry.Exporter.Console         1.11.2 -> 1.14.0
  OpenTelemetry.Extensions.Hosting       1.11.2 -> 1.14.0
  OpenTelemetry.Instrumentation.Runtime  1.11.1 -> 1.14.0

Version color legend:
<red>   : Major version update or pre-release version. Possible breaking changes.
<yellow>: Minor version update. Backwards-compatible features added.
<green> : Patch version update. Backwards-compatible bug fixes.

You can upgrade packages to the latest version by passing the -u or -u:prompt option.
Elapsed: 00:00:01.9107266
2025-12-18 14:11:50
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet outdated; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 14:13:53
On branch main
Your branch is ahead of 'origin/main' by 19 commits.
  (use "git push" to publish your local commits)

nothing to commit, working tree clean
2025-12-18 14:13:53
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 14:13:53
Enumerating objects: 19, done.
Counting objects: 100% (19/19), done.
Delta compression using up to 12 threads
Compressing objects: 100% (10/10), done.
Writing objects: 100% (12/12), 12.21 KiB | 2.03 MiB/s, done.
Total 12 (delta 7), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (7/7), completed with 6 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   b445949..68d1dff  main -> main
2025-12-18 14:13:54
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 14:13:54
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 19 files to export
Processing (1/19): :\Users\kushal\source\repos\MyImapDownloader\Directory.Build.props
Processing (2/19): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (3/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (4/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\appsettings.json
Processing (5/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (6/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (7/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (8/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs
Processing (9/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (10/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (11/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (12/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\DiagnosticsConfig.cs
Processing (13/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileLogExporter.cs
Processing (14/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileMetricsExporter.cs
Processing (15/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileTraceExporter.cs
Processing (16/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonTelemetryFileWriter.cs
Processing (17/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryConfiguration.cs
Processing (18/19): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryExtensions.cs
Processing (19/19): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 19
Output file size: 0.07 MB
2025-12-18 14:13:54
2025-12-18 14:13:54
[main 9fe1428] dump code for llm
 1 file changed, 7 insertions(+), 7 deletions(-)
2025-12-18 14:13:54
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 14:13:55

Build succeeded in 0.4s
2025-12-18 14:13:55
Restore complete (0.7s)
  MyImapDownloader net10.0 failed with 11 error(s) (0.3s)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileMetricsExporter.cs(80,73): error CS1061: 'ExponentialHistogramData' does not contain a definition for 'Sum' and no accessible extension method 'Sum' accepting a first argument of type 'ExponentialHistogramData' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileMetricsExporter.cs(81,73): error CS1061: 'ExponentialHistogramData' does not contain a definition for 'Count' and no accessible extension method 'Count' accepting a first argument of type 'ExponentialHistogramData' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs(126,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs(88,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(125,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(132,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(244,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs(253,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs(325,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(425,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs(448,22): error CS1061: 'Activity' does not contain a definition for 'RecordException' and no accessible extension method 'RecordException' accepting a first argument of type 'Activity' could be found (are you missing a using directive or an assembly reference?)

Build failed with 11 error(s) in 1.3s
2025-12-18 14:13:57
Discovering projects...
Analyzing project(s)...
Analyzing dependencies...
No outdated dependencies were detected
Elapsed: 00:00:01.9208419
2025-12-18 14:13:59
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet outdated; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 14:29:12
On branch main
Your branch is ahead of 'origin/main' by 21 commits.
  (use "git push" to publish your local commits)

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   docs/llm/output.txt

no changes added to commit (use "git add" and/or "git commit -a")
2025-12-18 14:29:12
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 14:29:12
Enumerating objects: 35, done.
Counting objects: 100% (35/35), done.
Delta compression using up to 12 threads
Compressing objects: 100% (19/19), done.
Writing objects: 100% (21/21), 8.64 KiB | 1.73 MiB/s, done.
Total 21 (delta 14), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (14/14), completed with 9 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   68d1dff..1959451  main -> main
2025-12-18 14:29:13
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 14:29:13
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 21 files to export
Processing (1/21): :\Users\kushal\source\repos\MyImapDownloader\Directory.Build.props
Processing (2/21): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (3/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (4/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\appsettings.json
Processing (5/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (6/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (7/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (8/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs
Processing (9/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (10/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (11/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (12/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\ActivityExtension.cs
Processing (13/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\DiagnosticsConfig.cs
Processing (14/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileLogExporter.cs
Processing (15/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileMetricsExporter.cs
Processing (16/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileTraceExporter.cs
Processing (17/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonTelemetryFileWriter.cs
Processing (18/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryConfiguration.cs
Processing (19/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryDirectoryResolver.cs
Processing (20/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryExtensions.cs
Processing (21/21): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 21
Output file size: 0.08 MB
2025-12-18 14:29:13
2025-12-18 14:29:13
[main 5676276] dump code for llm
 2 files changed, 947 insertions(+), 203 deletions(-)
2025-12-18 14:29:14
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 14:29:14

Build succeeded in 0.4s
2025-12-18 14:29:14
Restore complete (0.9s)
  MyImapDownloader net10.0 failed with 1 error(s) and 4 warning(s) (2.1s)
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryExtensions.cs(32,13): warning CS8634: The type 'MyImapDownloader.Telemetry.JsonTelemetryFileWriter?' cannot be used as type parameter 'TService' in the generic type or method 'ServiceCollectionServiceExtensions.AddSingleton<TService>(IServiceCollection, Func<IServiceProvider, TService>)'. Nullability of type argument 'MyImapDownloader.Telemetry.JsonTelemetryFileWriter?' doesn't match 'class' constraint.
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryExtensions.cs(79,9): warning CS8634: The type 'MyImapDownloader.Telemetry.JsonTelemetryFileWriter?' cannot be used as type parameter 'TService' in the generic type or method 'ServiceCollectionServiceExtensions.AddSingleton<TService>(IServiceCollection, TService)'. Nullability of type argument 'MyImapDownloader.Telemetry.JsonTelemetryFileWriter?' doesn't match 'class' constraint.
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryExtensions.cs(80,9): warning CS8634: The type 'MyImapDownloader.Telemetry.JsonTelemetryFileWriter?' cannot be used as type parameter 'TService' in the generic type or method 'ServiceCollectionServiceExtensions.AddSingleton<TService>(IServiceCollection, TService)'. Nullability of type argument 'MyImapDownloader.Telemetry.JsonTelemetryFileWriter?' doesn't match 'class' constraint.
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryExtensions.cs(81,9): warning CS8634: The type 'MyImapDownloader.Telemetry.JsonTelemetryFileWriter?' cannot be used as type parameter 'TService' in the generic type or method 'ServiceCollectionServiceExtensions.AddSingleton<TService>(IServiceCollection, TService)'. Nullability of type argument 'MyImapDownloader.Telemetry.JsonTelemetryFileWriter?' doesn't match 'class' constraint.
    C:\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileMetricsExporter.cs(95,53): error CS1061: 'ExponentialHistogramData' does not contain a definition for 'Count' and no accessible extension method 'Count' accepting a first argument of type 'ExponentialHistogramData' could be found (are you missing a using directive or an assembly reference?)

Build failed with 1 error(s) and 4 warning(s) in 3.2s
2025-12-18 14:29:18
Discovering projects...
Analyzing project(s)...
Analyzing dependencies...
No outdated dependencies were detected
Elapsed: 00:00:01.9071127
2025-12-18 14:29:20
PS C:\Users\kushal\source\repos\MyImapDownloader> Set-Location "C:\Users\kushal\source\repos\MyImapDownloader"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git status; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git push mine --all; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; Get-Content .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; .\export.ps1; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git add .; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; git commit --message "dump code for llm"; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet --info; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet clean; Get-Date -Format "yyyy-MM-dd HH:mm:ss"; dotnet build; Get-Date -Format "yyyy-MM-dd HH:mm:ss";
2025-12-18 14:36:23
On branch main
Your branch is ahead of 'origin/main' by 23 commits.
  (use "git push" to publish your local commits)

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   docs/llm/output.txt

no changes added to commit (use "git add" and/or "git commit -a")
2025-12-18 14:36:23
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 14:36:23
Enumerating objects: 25, done.
Counting objects: 100% (25/25), done.
Delta compression using up to 12 threads
Compressing objects: 100% (13/13), done.
Writing objects: 100% (15/15), 8.31 KiB | 1.66 MiB/s, done.
Total 15 (delta 10), reused 0 (delta 0), pack-reused 0 (from 0)
remote: Resolving deltas: 100% (10/10), completed with 7 local objects.
To https://github.com/collabskus/MyImapDownloader.git
   1959451..ab2c42e  main -> main
2025-12-18 14:36:24
# Export Project Files to Single Text File
# PowerShell 5 compatible script

param(
    [string]$ProjectPath = ".",
    [string]$OutputFile = "docs\llm\dump.txt"
)

# Define file extensions to include
$IncludeExtensions = @(
    "*.cs",           # C# files
    "*.json",         # JSON configuration files
    "*.xml",          # XML files
    "*.csproj",       # C# project files
    "*.sln",          # Solution files
    "*.slnx"          # Solution X files
    "*.props"         # Properties files
    "*.config",       # Configuration files
    "*.cshtml",       # Razor views
    "*.razor",        # Razor components
    "*.js",           # JavaScript files
    "*.css",          # CSS files
    "*.scss",         # SCSS files
    "*.html",         # HTML files
    "*.yml",          # YAML files
    "*.yaml",         # YAML files
    "*.sql"           # SQL files
)

# Directories to exclude
$ExcludeDirectories = @(
    "bin",
    "obj",
    ".vs",
    ".git",
    "node_modules",
    "packages",
    ".vscode",
    ".idea",
    "docs"            # Documentation folder
)

# Files to exclude
$ExcludeFiles = @(
    "*.exe",
    "*.dll",
    "*.pdb",
    "*.cache",
    "*.log",
    "*.md",           # Markdown files
    "*.txt",          # Text files
    "LICENSE*",       # License files
    "LICENCE*"        # Alternative spelling
)

Write-Host "Starting project export..." -ForegroundColor Green
Write-Host "Project Path: $ProjectPath" -ForegroundColor Yellow
Write-Host "Output File: $OutputFile" -ForegroundColor Yellow

# Initialize output file
$OutputPath = Join-Path $ProjectPath $OutputFile
"" | Out-File -FilePath $OutputPath -Encoding UTF8

# Add header
$Header = @"
===============================================================================
PROJECT EXPORT
Generated: $(Get-Date)
Project Path: $((Resolve-Path $ProjectPath).Path)
===============================================================================

"@

$Header | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Generate directory structure using tree command if available, otherwise use PowerShell
Write-Host "Generating directory structure..." -ForegroundColor Cyan

"DIRECTORY STRUCTURE:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"===================" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Try to use tree command first
try {
    $treeOutput = & tree $ProjectPath /F /A 2>$null
    if ($LASTEXITCODE -eq 0) {
        $treeOutput | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    } else {
        throw "Tree command failed"
    }
} catch {
    # Fallback to PowerShell-based tree
    Write-Host "Tree command not available, using PowerShell alternative..." -ForegroundColor Yellow

    function Get-DirectoryTree {
        param([string]$Path, [string]$Prefix = "")

        $items = Get-ChildItem -Path $Path -Force | Where-Object {
            $_.Name -notin $ExcludeDirectories
        } | Sort-Object @{Expression={$_.PSIsContainer}; Descending=$true}, Name

        for ($i = 0; $i -lt $items.Count; $i++) {
            $item = $items[$i]
            $isLast = ($i -eq $items.Count - 1)
            $connector = if ($isLast) { "+-- " } else { "+-- " }

            "$Prefix$connector$($item.Name)" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

            if ($item.PSIsContainer) {
                $newPrefix = if ($isLast) { "$Prefix    " } else { "$Prefix|   " }
                Get-DirectoryTree -Path $item.FullName -Prefix $newPrefix
            }
        }
    }

    (Split-Path $ProjectPath -Leaf) | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    Get-DirectoryTree -Path $ProjectPath
}

"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

# Get all relevant files
Write-Host "Collecting files..." -ForegroundColor Cyan

$AllFiles = @()
foreach ($extension in $IncludeExtensions) {
    $files = Get-ChildItem -Path $ProjectPath -Recurse -Include $extension -File | Where-Object {
        $exclude = $false

        # Check excluded directories
        foreach ($excludeDir in $ExcludeDirectories) {
            if ($_.FullName -like "*\$excludeDir\*") {
                $exclude = $true
                break
            }
        }

        # Check excluded files
        if (-not $exclude) {
            foreach ($excludeFile in $ExcludeFiles) {
                if ($_.Name -like $excludeFile) {
                    $exclude = $true
                    break
                }
            }
        }

        -not $exclude
    }
    $AllFiles += $files
}

# Remove duplicates and sort
$AllFiles = $AllFiles | Sort-Object FullName | Get-Unique -AsString

Write-Host "Found $($AllFiles.Count) files to export" -ForegroundColor Green

# Export each file
"FILE CONTENTS:" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"==============" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
"" | Out-File -FilePath $OutputPath -Append -Encoding UTF8

$fileCount = 0
foreach ($file in $AllFiles) {
    $fileCount++
    $relativePath = $file.FullName.Substring($ProjectPath.Length).TrimStart('\')

    Write-Host "Processing ($fileCount/$($AllFiles.Count)): $relativePath" -ForegroundColor White

    $separator = "=" * 80
    $fileHeader = @"
$separator
FILE: $relativePath
SIZE: $([math]::Round($file.Length / 1KB, 2)) KB
MODIFIED: $($file.LastWriteTime)
$separator

"@

    $fileHeader | Out-File -FilePath $OutputPath -Append -Encoding UTF8

    try {
        # Read file content with error handling
        $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        if ($content) {
            $content | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        } else {
            "[EMPTY FILE]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
        }
    } catch {
        "[ERROR READING FILE: $($_.Exception.Message)]" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    }

    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
    "" | Out-File -FilePath $OutputPath -Append -Encoding UTF8
}

# Add footer
$Footer = @"
===============================================================================
EXPORT COMPLETED: $(Get-Date)
Total Files Exported: $fileCount
Output File: $OutputPath
===============================================================================
"@

$Footer | Out-File -FilePath $OutputPath -Append -Encoding UTF8

Write-Host "`nExport completed successfully!" -ForegroundColor Green
Write-Host "Output file: $OutputPath" -ForegroundColor Yellow
Write-Host "Total files exported: $fileCount" -ForegroundColor Green

# Display file size
$outputFileInfo = Get-Item $OutputPath
Write-Host "Output file size: $([math]::Round($outputFileInfo.Length / 1MB, 2)) MB" -ForegroundColor Cyan
2025-12-18 14:36:24
Starting project export...
Project Path: .
Output File: docs\llm\dump.txt
Generating directory structure...
Collecting files...
Found 21 files to export
Processing (1/21): :\Users\kushal\source\repos\MyImapDownloader\Directory.Build.props
Processing (2/21): :\Users\kushal\source\repos\MyImapDownloader\Directory.Packages.props
Processing (3/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader.sln
Processing (4/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\appsettings.json
Processing (5/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\DownloadOptions.cs
Processing (6/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadException.cs
Processing (7/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailDownloadService.cs
Processing (8/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\EmailStorageService.cs
Processing (9/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\ImapConfiguration.cs
Processing (10/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\MyImapDownloader.csproj
Processing (11/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Program.cs
Processing (12/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\ActivityExtension.cs
Processing (13/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\DiagnosticsConfig.cs
Processing (14/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileLogExporter.cs
Processing (15/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileMetricsExporter.cs
Processing (16/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonFileTraceExporter.cs
Processing (17/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\JsonTelemetryFileWriter.cs
Processing (18/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryConfiguration.cs
Processing (19/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryDirectoryResolver.cs
Processing (20/21): :\Users\kushal\source\repos\MyImapDownloader\MyImapDownloader\Telemetry\TelemetryExtensions.cs
Processing (21/21): :\Users\kushal\source\repos\MyImapDownloader\qodana.yaml

Export completed successfully!
Output file: .\docs\llm\dump.txt
Total files exported: 21
Output file size: 0.09 MB
2025-12-18 14:36:24
2025-12-18 14:36:24
[main d0e9374] dump code for llm
 2 files changed, 501 insertions(+), 22 deletions(-)
2025-12-18 14:36:25
.NET SDK:
 Version:           10.0.101
 Commit:            fad253f51b
 Workload version:  10.0.100-manifests.9f71effe
 MSBuild version:   18.0.6+fad253f51

Runtime Environment:
 OS Name:     Windows
 OS Version:  10.0.26100
 OS Platform: Windows
 RID:         win-x64
 Base Path:   C:\Program Files\dotnet\sdk\10.0.101\

.NET workloads installed:
There are no installed workloads to display.
Configured to use workload sets when installing new manifests.
No workload sets are installed. Run "dotnet workload restore" to install a workload set.

Host:
  Version:      10.0.1
  Architecture: x64
  Commit:       fad253f51b

.NET SDKs installed:
  9.0.308 [C:\Program Files\dotnet\sdk]
  10.0.100-rc.1.25451.107 [C:\Program Files\dotnet\sdk]
  10.0.101 [C:\Program Files\dotnet\sdk]

.NET runtimes installed:
  Microsoft.AspNetCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.AspNetCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]
  Microsoft.NETCore.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.NETCore.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
  Microsoft.WindowsDesktop.App 8.0.22 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 9.0.11 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
  Microsoft.WindowsDesktop.App 10.0.1 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]

Other architectures found:
  x86   [C:\Program Files (x86)\dotnet]
    registered at [HKLM\SOFTWARE\dotnet\Setup\InstalledVersions\x86\InstallLocation]

Environment variables:
  Not set

global.json file:
  Not found

Learn more:
  https://aka.ms/dotnet/info

Download .NET:
  https://aka.ms/dotnet/download
2025-12-18 14:36:25

Build succeeded in 0.4s
2025-12-18 14:36:25
Restore complete (0.7s)
  MyImapDownloader net10.0 succeeded (0.8s) â†’ MyImapDownloader\bin\Debug\net10.0\MyImapDownloader.dll

Build succeeded in 1.8s
2025-12-18 14:36:27
PS C:\Users\kushal\source\repos\MyImapDownloader>
